{% extends 'base.html' %}
{% load static %}

{% block title %}Booking Details - TableBook{% endblock %}

{% block content %}
<div class="text-center mb-3">
    <h1><i class="fas fa-receipt"></i> Booking Details</h1>
    <p>View and manage your reservation</p>
</div>

{% if booking %}
<div class="card" style="max-width: 800px; margin: 0 auto;">
    <div class="card-header">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2 class="card-title">
                <i class="fas fa-calendar-check"></i> Reservation #{{ booking.id|slice:":8" }}
            </h2>
            <span class="status-badge status-{{ booking.status }}">
                {{ booking.get_status_display }}
            </span>
        </div>
    </div>
    
    <div class="booking-details">
        <div class="booking-detail-row">
            <span class="booking-detail-label">Booking ID:</span>
            <span class="booking-detail-value">{{ booking.id }}</span>
        </div>
        
        <div class="booking-detail-row">
            <span class="booking-detail-label">Guest Name:</span>
            <span class="booking-detail-value">{{ booking.guest_name }}</span>
        </div>
        
        <div class="booking-detail-row">
            <span class="booking-detail-label">Email:</span>
            <span class="booking-detail-value">{{ booking.guest_email }}</span>
        </div>
        
        {% if booking.guest_phone %}
        <div class="booking-detail-row">
            <span class="booking-detail-label">Phone:</span>
            <span class="booking-detail-value">{{ booking.guest_phone }}</span>
        </div>
        {% endif %}
        
        <div class="booking-detail-row">
            <span class="booking-detail-label">Restaurant:</span>
            <span class="booking-detail-value">
                <a href="{% url 'app:restaurant_detail' booking.restaurant.id %}" style="color: var(--secondary-color); text-decoration: none;">
                    {{ booking.restaurant.name }}
                </a>
            </span>
        </div>
        
        <div class="booking-detail-row">
            <span class="booking-detail-label">Location:</span>
            <span class="booking-detail-value">{{ booking.restaurant.location }}</span>
        </div>
        
        <div class="booking-detail-row">
            <span class="booking-detail-label">Table Size:</span>
            <span class="booking-detail-value">{{ booking.table.size }} people</span>
        </div>
        
        <div class="booking-detail-row">
            <span class="booking-detail-label">Date:</span>
            <span class="booking-detail-value">{{ booking.visit_date|date:"F d, Y" }}</span>
        </div>
        
        <div class="booking-detail-row">
            <span class="booking-detail-label">Time:</span>
            <span class="booking-detail-value">{{ booking.visit_time|time:"g:i A" }}</span>
        </div>
        
        <div class="booking-detail-row">
            <span class="booking-detail-label">Party Size:</span>
            <span class="booking-detail-value">{{ booking.number_of_guests }} guests</span>
        </div>
        
        {% if booking.special_requests %}
        <div class="booking-detail-row">
            <span class="booking-detail-label">Special Requests:</span>
            <span class="booking-detail-value">{{ booking.special_requests }}</span>
        </div>
        {% endif %}
        
        <div class="booking-detail-row">
            <span class="booking-detail-label">Created:</span>
            <span class="booking-detail-value">{{ booking.created_at|date:"F d, Y g:i A" }}</span>
        </div>
        
        <div class="booking-detail-row">
            <span class="booking-detail-label">Last Updated:</span>
            <span class="booking-detail-value">{{ booking.updated_at|date:"F d, Y g:i A" }}</span>
        </div>
    </div>
</div>

<!-- Action Buttons -->
<div style="text-align: center; margin-top: 2rem;">
    {% if booking.can_be_cancelled %}
    <a href="{% url 'app:cancel_booking' booking.id %}" class="btn btn-danger">
        <i class="fas fa-times"></i> Cancel Booking
    </a>
    {% endif %}
    
    <a href="{% url 'app:index' %}" class="btn btn-primary">
        <i class="fas fa-plus"></i> Book Another Table
    </a>
    
    <a href="{% url 'app:restaurant_list' %}" class="btn btn-secondary">
        <i class="fas fa-list"></i> Browse Restaurants
    </a>
</div>

<!-- Restaurant Information -->
<div class="card" style="max-width: 800px; margin: 2rem auto 0;">
    <div class="card-header">
        <h3 class="card-title">
            <i class="fas fa-utensils"></i> Restaurant Information
        </h3>
    </div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
        <div>
            <h4 style="color: var(--primary-color); margin-bottom: 1rem;">Contact Details</h4>
            {% if booking.restaurant.phone %}
            <p><i class="fas fa-phone"></i> {{ booking.restaurant.phone }}</p>
            {% endif %}
            {% if booking.restaurant.email %}
            <p><i class="fas fa-envelope"></i> {{ booking.restaurant.email }}</p>
            {% endif %}
            <p><i class="fas fa-map-marker-alt"></i> {{ booking.restaurant.location }}</p>
        </div>
        
        <div>
            <h4 style="color: var(--primary-color); margin-bottom: 1rem;">Hours & Info</h4>
            {% if booking.restaurant.opening_hours %}
            <p><i class="fas fa-clock"></i> {{ booking.restaurant.opening_hours }}</p>
            {% endif %}
            {% if booking.restaurant.description %}
            <p><i class="fas fa-info-circle"></i> {{ booking.restaurant.description }}</p>
            {% endif %}
        </div>
    </div>
</div>

{% else %}
<div class="card text-center">
    <div style="font-size: 3rem; color: var(--light-text); margin-bottom: 1rem;">
        <i class="fas fa-exclamation-triangle"></i>
    </div>
    <h2>Booking Not Found</h2>
    <p>The booking you're looking for doesn't exist or has been removed.</p>
    <a href="{% url 'app:index' %}" class="btn btn-primary">Book a Table</a>
</div>
{% endif %}
{% endblock %}
