{% extends 'base.html' %}
{% load static %}

{% block title %}Booking Confirmed - TableBook{% endblock %}

{% block content %}
<div class="text-center">
    <!-- Success Animation -->
    <div style="font-size: 4rem; color: var(--success-color); margin-bottom: 1rem;">
        <i class="fas fa-check-circle"></i>
    </div>
    
    <h1 style="color: var(--success-color); margin-bottom: 1rem;">
        ðŸŽ‰ Booking Confirmed!
    </h1>
    
    <p style="font-size: 1.2rem; margin-bottom: 2rem; color: var(--light-text);">
        Thank you! Your table has been successfully reserved.
    </p>

    {% if booking %}
    <div class="card" style="max-width: 600px; margin: 0 auto;">
        <div class="card-header">
            <h2 class="card-title">
                <i class="fas fa-receipt"></i> Booking Details
            </h2>
        </div>
        
        <div class="booking-details">
            <div class="booking-detail-row">
                <span class="booking-detail-label">Booking ID:</span>
                <span class="booking-detail-value">{{ booking.id }}</span>
            </div>
            
            <div class="booking-detail-row">
                <span class="booking-detail-label">Guest Name:</span>
                <span class="booking-detail-value">{{ booking.guest_name }}</span>
            </div>
            
            <div class="booking-detail-row">
                <span class="booking-detail-label">Email:</span>
                <span class="booking-detail-value">{{ booking.guest_email }}</span>
            </div>
            
            {% if booking.guest_phone %}
            <div class="booking-detail-row">
                <span class="booking-detail-label">Phone:</span>
                <span class="booking-detail-value">{{ booking.guest_phone }}</span>
            </div>
            {% endif %}
            
            <div class="booking-detail-row">
                <span class="booking-detail-label">Restaurant:</span>
                <span class="booking-detail-value">{{ booking.restaurant.name }}</span>
            </div>
            
            <div class="booking-detail-row">
                <span class="booking-detail-label">Location:</span>
                <span class="booking-detail-value">{{ booking.restaurant.location }}</span>
            </div>
            
            <div class="booking-detail-row">
                <span class="booking-detail-label">Table Size:</span>
                <span class="booking-detail-value">{{ booking.table.size }} people</span>
            </div>
            
            <div class="booking-detail-row">
                <span class="booking-detail-label">Date:</span>
                <span class="booking-detail-value">{{ booking.visit_date|date:"F d, Y" }}</span>
            </div>
            
            <div class="booking-detail-row">
                <span class="booking-detail-label">Time:</span>
                <span class="booking-detail-value">{{ booking.visit_time|time:"g:i A" }}</span>
            </div>
            
            <div class="booking-detail-row">
                <span class="booking-detail-label">Party Size:</span>
                <span class="booking-detail-value">{{ booking.number_of_guests }} guests</span>
            </div>
            
            <div class="booking-detail-row">
                <span class="booking-detail-label">Status:</span>
                <span class="booking-detail-value">
                    <span class="status-badge status-{{ booking.status }}">
                        {{ booking.get_status_display }}
                    </span>
                </span>
            </div>
            
            {% if booking.special_requests %}
            <div class="booking-detail-row">
                <span class="booking-detail-label">Special Requests:</span>
                <span class="booking-detail-value">{{ booking.special_requests }}</span>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- Action Buttons -->
    <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
        <a href="{% url 'app:index' %}" class="btn btn-primary">
            <i class="fas fa-plus"></i> Book Another Table
        </a>
        
        {% if booking %}
        <a href="{% url 'app:booking_detail' booking.id %}" class="btn btn-secondary">
            <i class="fas fa-eye"></i> View Booking Details
        </a>
        {% endif %}
        
        <a href="{% url 'app:restaurant_list' %}" class="btn btn-secondary">
            <i class="fas fa-list"></i> Browse Restaurants
        </a>
    </div>

    <!-- Important Notes -->
    <div class="card" style="max-width: 600px; margin: 2rem auto 0;">
        <div class="card-header">
            <h3 class="card-title">
                <i class="fas fa-info-circle"></i> Important Information
            </h3>
        </div>
        
        <ul style="list-style: none; padding: 0; text-align: left;">
            <li style="margin-bottom: 0.5rem;">
                <i class="fas fa-envelope" style="color: var(--secondary-color); margin-right: 0.5rem;"></i>
                A confirmation email has been sent to {{ booking.guest_email }}
            </li>
            <li style="margin-bottom: 0.5rem;">
                <i class="fas fa-clock" style="color: var(--secondary-color); margin-right: 0.5rem;"></i>
                Please arrive 10 minutes before your reservation time
            </li>
            <li style="margin-bottom: 0.5rem;">
                <i class="fas fa-phone" style="color: var(--secondary-color); margin-right: 0.5rem;"></i>
                Contact the restaurant directly for any changes or cancellations
            </li>
            <li style="margin-bottom: 0.5rem;">
                <i class="fas fa-calendar" style="color: var(--secondary-color); margin-right: 0.5rem;"></i>
                You can view or cancel your booking using the booking ID above
            </li>
        </ul>
    </div>

    <!-- Auto-redirect notice -->
    <div style="margin-top: 2rem; padding: 1rem; background: var(--light-bg); border-radius: var(--border-radius); max-width: 400px; margin-left: auto; margin-right: auto;">
        <p style="color: var(--light-text); margin: 0;">
            <i class="fas fa-arrow-right"></i> 
            You will be redirected to the home page in <span id="countdown">10</span> seconds...
        </p>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
    // Countdown timer
    let countdown = 10;
    const countdownElement = $('#countdown');
    
    const timer = setInterval(function() {
        countdown--;
        countdownElement.text(countdown);
        
        if (countdown <= 0) {
            clearInterval(timer);
            window.location.href = "{% url 'app:index' %}";
        }
    }, 1000);
    
    // Allow user to cancel auto-redirect
    $('.btn').on('click', function() {
        clearInterval(timer);
        $('.countdown-notice').hide();
    });
});
</script>
{% endblock %}
